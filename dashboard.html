<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Acta Express</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="./styles.css">
    
    <!-- Estilos adicionales para dashboard -->
    <style>
        /* Responsive utilities */
        @media (max-width: 767px) {
            .mobile\:p-3{padding:.75rem}
            .mobile\:text-lg{font-size:1.125rem}
            .mobile\:grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}
            .mobile\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
            .mobile\:w-full{width:100%}
            .mobile\:py-3{padding-top:.75rem;padding-bottom:.75rem}
            .mobile\:text-sm{font-size:.875rem}
        }
        
        /* Gradientes adicionales */
        .bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}
        .from-blue-50{--tw-gradient-from:#eff6ff;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(239,246,255,0))}
        .to-blue-100{--tw-gradient-to:#dbeafe}
        .from-green-50{--tw-gradient-from:#f0fdf4;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(240,253,244,0))}
        .to-green-100{--tw-gradient-to:#dcfce7}
        .from-purple-50{--tw-gradient-from:#faf5ff;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(250,245,255,0))}
        .to-purple-100{--tw-gradient-to:#f3e8ff}
        .from-orange-50{--tw-gradient-from:#fff7ed;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(255,247,237,0))}
        .to-orange-100{--tw-gradient-to:#fed7aa}
        .from-slate-50{--tw-gradient-from:#f8fafc;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(248,250,252,0))}
        .to-slate-100{--tw-gradient-to:#f1f5f9}
        .from-indigo-50{--tw-gradient-from:#eef2ff;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(238,242,255,0))}
        .to-indigo-100{--tw-gradient-to:#e0e7ff}
        
        /* Bordes y colores */
        .border-2{border-width:2px}
        .border-blue-200{border-color:#bfdbfe}
        .border-green-200{border-color:#bbf7d0}
        .border-purple-200{border-color:#e9d5ff}
        .border-orange-200{border-color:#fed7aa}
        .border-slate-200{border-color:#e2e8f0}
        .border-indigo-200{border-color:#c7d2fe}
        .border-indigo-400{border-color:#818cf8}
        
        .text-blue-800{color:#1e40af}
        .text-green-800{color:#166534}
        .text-purple-800{color:#6b21a8}
        .text-orange-800{color:#9a3412}
        .text-slate-800{color:#1e293b}
        .text-indigo-800{color:#3730a3}
        .text-indigo-700{color:#4338ca}
        
        /* Focus states */
        .focus\:border-indigo-400:focus{border-color:#818cf8}
        
        /* Transiciones */
        .transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-duration:150ms}
        
        /* Hover effects */
        .hover\:bg-white\/30:hover{background-color:rgba(255,255,255,.3)}
    </style>
</head>
<body class="bg-slate-50 text-slate-800">
    <header class="p-4 mobile:p-3 bg-gradient-to-r from-sky-600 to-blue-700 text-white shadow-lg">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-xl mobile:text-lg font-bold">📊 Dashboard Acta Express</h1>
                <p class="text-sm mobile:text-xs opacity-90 mobile:hidden">Análisis y reportes de actas de visita</p>
                <p class="text-xs opacity-90 md:hidden">Reportes y estadísticas</p>
            </div>
            <div class="mobile:hidden">
                <a href="./index.html" class="text-sm bg-white/20 px-3 py-1 rounded-full hover:bg-white/30 transition">← Volver</a>
            </div>
        </div>
    </header>

    <main class="p-4 space-y-6 max-w-7xl mx-auto">
        <!-- Control de Datos -->
        <section class="card mobile:p-3">
            <h2 class="card-title mobile:text-lg">🎛️ Control de Datos</h2>
            
            <!-- Botones principales -->
            <div class="grid grid-cols-2 mobile:grid-cols-1 gap-3 mb-4">
                <button id="btnCargarExcel" class="btn btn-primary mobile:w-full mobile:py-3">📊 Cargar Excel</button>
                <button id="btnCargarDatos" class="btn btn-success mobile:w-full mobile:py-3">🔄 Cargar IndexedDB</button>
            </div>
            
            <!-- Botones secundarios -->
            <div class="grid grid-cols-3 mobile:grid-cols-2 gap-2 mb-4">
                <button id="btnGenerarReportePDF" class="btn btn-outline mobile:text-sm" disabled>📄 PDF</button>
                <button id="btnGenerarReporte" class="btn btn-outline mobile:text-sm" disabled>📊 Excel</button>
                <button id="btnDebug" class="btn btn-ghost mobile:text-sm">🐛 Debug</button>
            </div>
            
            <!-- Botón de peligro -->
            <div class="border-t pt-4">
                <button id="btnBorrarTodas" class="btn btn-danger mobile:w-full mobile:text-sm">🗑️ Borrar Todas las Actas</button>
            </div>
            
            <p id="estadoDatos" class="text-xs text-slate-500 mt-3 p-2 bg-slate-50 rounded"></p>
        </section>

        <!-- Resumen General -->
        <div id="resumenGeneral" class="hidden grid gap-4 md:grid-cols-4 mobile:grid-cols-2">
            <div class="card bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200 shadow-sm">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-3xl font-bold text-blue-600" id="totalActas">0</div>
                        <div class="text-sm text-blue-800 font-medium">Total Actas</div>
                    </div>
                    <div class="text-2xl">📋</div>
                </div>
            </div>
            <div class="card bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-200 shadow-sm">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-3xl font-bold text-green-600" id="totalCompromisos">0</div>
                        <div class="text-sm text-green-800 font-medium">Zonas Únicas</div>
                    </div>
                    <div class="text-2xl">🎯</div>
                </div>
            </div>
            <div class="card bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-200 shadow-sm">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-3xl font-bold text-purple-600" id="clientesUnicos">0</div>
                        <div class="text-sm text-purple-800 font-medium">Contactos Únicos</div>
                    </div>
                    <div class="text-2xl">👥</div>
                </div>
            </div>
            <div class="card bg-gradient-to-br from-orange-50 to-orange-100 border-2 border-orange-200 shadow-sm">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-3xl font-bold text-orange-600" id="promedioCompromisos">0</div>
                        <div class="text-sm text-orange-800 font-medium">Promedio Temas/Acta</div>
                    </div>
                    <div class="text-2xl">📊</div>
                </div>
            </div>
        </div>

        <!-- Gráficos -->
        <div id="graficos" class="hidden space-y-6">
            <h2 class="text-xl font-bold text-slate-800 mb-4">📈 Análisis Visual</h2>
            
            <div class="grid gap-6 md:grid-cols-2">
                <!-- Actas por Mes -->
                <div class="card bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200">
                    <h3 class="card-title text-blue-800">📅 Actas por Mes</h3>
                    <div class="p-4">
                        <canvas id="chartActasMes" width="400" height="250"></canvas>
                    </div>
                </div>

                <!-- Zonas de Visita -->
                <div class="card bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-200">
                    <h3 class="card-title text-green-800">🎯 Zonas de Visita</h3>
                    <div class="p-4">
                        <canvas id="chartMotivos" width="400" height="250"></canvas>
                    </div>
                </div>

                <!-- Top Contactos -->
                <div class="card bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-200">
                    <h3 class="card-title text-purple-800">🏆 Top 10 Contactos</h3>
                    <div class="p-4">
                        <canvas id="chartTopClientes" width="400" height="250"></canvas>
                    </div>
                </div>

                <!-- Temas Tratados -->
                <div class="card bg-gradient-to-br from-orange-50 to-orange-100 border-2 border-orange-200">
                    <h3 class="card-title text-orange-800">✅ Temas Tratados</h3>
                    <div class="p-4">
                        <canvas id="chartCompromisosEstado" width="400" height="250"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tablas de Datos -->
        <div id="tablas" class="hidden space-y-6">
            <h2 class="text-xl font-bold text-slate-800 mb-4">📊 Datos Detallados</h2>
            
            <!-- Tabla de Actas Recientes -->
            <section class="card bg-gradient-to-br from-slate-50 to-slate-100 border-2 border-slate-200">
                <h3 class="card-title text-slate-800">📋 Actas Recientes</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-slate-200">
                            <tr>
                                <th class="p-3 text-left font-semibold">ID</th>
                                <th class="p-3 text-left font-semibold">Empresa</th>
                                <th class="p-3 text-left font-semibold">Contacto</th>
                                <th class="p-3 text-left font-semibold">Fecha</th>
                                <th class="p-3 text-left font-semibold">Contrato</th>
                                <th class="p-3 text-left font-semibold">Zona</th>
                                <th class="p-3 text-left font-semibold">Ejecutivo</th>
                            </tr>
                        </thead>
                        <tbody id="tablaActasRecientes" class="bg-white">
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <!-- Filtros -->
        <div id="filtros" class="hidden card bg-gradient-to-br from-indigo-50 to-indigo-100 border-2 border-indigo-200">
            <h3 class="card-title text-indigo-800">🔍 Filtros de Búsqueda</h3>
            
            <div class="grid gap-4 md:grid-cols-4 mobile:grid-cols-2">
                <div>
                    <label class="lbl text-indigo-700">📅 Fecha Desde</label>
                    <input type="date" id="filtroFechaDesde" class="inp border-indigo-200 focus:border-indigo-400">
                </div>
                <div>
                    <label class="lbl text-indigo-700">📅 Fecha Hasta</label>
                    <input type="date" id="filtroFechaHasta" class="inp border-indigo-200 focus:border-indigo-400">
                </div>
                <div>
                    <label class="lbl text-indigo-700">🎯 Zona</label>
                    <select id="filtroMotivo" class="inp border-indigo-200 focus:border-indigo-400">
                        <option value="">Todas las zonas</option>
                    </select>
                </div>
                <div>
                    <label class="lbl text-indigo-700">👤 Ejecutivo</label>
                    <select id="filtroEjecutivo" class="inp border-indigo-200 focus:border-indigo-400">
                        <option value="">Todos los ejecutivos</option>
                    </select>
                </div>
            </div>
            
            <div class="mt-4 flex flex-wrap gap-2 justify-center">
                <button id="btnAplicarFiltros" class="btn btn-primary mobile:w-full">🔍 Aplicar Filtros</button>
                <button id="btnLimpiarFiltros" class="btn btn-outline mobile:w-full">🗑️ Limpiar</button>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="./dashboard.js"></script>
</body>
</html>
